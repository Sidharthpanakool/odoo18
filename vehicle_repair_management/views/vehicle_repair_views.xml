<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="action_vehicle_repair_list_view"
            model="ir.ui.view">
        <field name="name">vehicle repair list</field>
        <field name="model">vehicle.repair</field>
        <field name="arch" type="xml">
            <list string="Channel"
                  decoration-danger="highlight_red"
                  decoration-warning="highlight_yellow">
                <field name="name" context="{'show_address':1}"/>
                <field name="reference_number"/>
                <field name="vehicle_number"/>
                <field name="service_advisor_id"/>
                <field name="start_date"/>
                <field name="delivery_date"/>
                <field name="vehicle_type"/>
                <field name="vehicle_model"/>
                <field name="total_sum_sum"/>
                <field name="labour_cost_sum"/>
                <field name="customer_complaints"/>
                <field name="company"/>

            </list>
        </field>
    </record>

    <record id="action_vehicle_repair_form_view" model="ir.ui.view">
        <field name="name">vehicle repair.form</field>
        <field name="model">vehicle.repair</field>
        <field name="arch" type="xml">

            <form string="Vehicle repair form view">

                <header>
                    <button name="action_confirm"
                            class=" btn btn-outline-primary o_form_button_create "
                            string="Confirm"
                            type="object"
                            data-hotkey="c" style="position: relative;"
                            invisible="status!= 'draft'"/>

                    <button name="action_confirm_delivery"
                            class=" btn btn-outline-primary o_form_button_create "
                            string="Ready for delivery"
                            type="object"
                            data-hotkey="c" style="position: relative;"
                            invisible="status!= 'progress'"/>

                    <button name="action_done"
                            class=" btn btn-outline-primary o_form_button_create "
                            string="Done"
                            type="object"
                            data-hotkey="c" style="position: relative;"
                            invisible="status not in ['cancel','delivery']"/>

                    <!--                    <button name="action_send_mail"-->
                    <!--                            type="object"-->
                    <!--                            string="Send Email"-->
                    <!--                            class="oe_highlight"-->
                    <!--                            invisible="status!= 'done'"/>-->

                    <button name="action_create_invoice"
                            class=" btn btn-outline-primary o_form_button_create "
                            string="Create Invoice"
                            type="object"
                            data-hotkey="c" style="position: relative;"
                            invisible="status not in ['progress','done','delivery']"/>


                    <field name="status" widget="statusbar"
                           statusbar_visible="draft,progress,delivery,done,cancelled"
                           options="{'clickable':1}"/>


                </header>
                <sheet>
                    <div name="button_box" position="inside" invisible="invoice_active==False">

                        <button class="oe_stat_button" type="object" icon="fa-book"
                                name="action_get_invoice_history" string="Invoice">


                        </button>
                    </div>

                    <div class="oe_button_box" name="button_box"/>
                    <widget name="web_ribbon" title="Paid" bg_color="text-bg-success"
                            invisible="not invoice_paid "/>
                    <field name="invoice_paid" invisible="1"/>
                    <div class="oe_title">
                        <h1>
                            <field name="reference_number" options="{'line_breaks': False}" widget="text"
                                   placeholder=" "/>
                        </h1>
                    </div>

                    <group>


                        <group>

                            <field name="name" context="{'show_address':1}"
                                   readonly="status not in['draft']"/>
                            <field name="service_advisor_id" readonly="status not in['draft']"/>
                            <field name="vehicle_number" readonly="status not in['draft']"/>
                            <field name="vehicle_type" readonly="status not in['draft']"/>
                            <field name="vehicle_model" readonly="status not in['draft']"/>
                            <field name="mobile_number" readonly="status not in['draft']"/>
                        </group>
                        <group>
                            <field name="vehicle_image" widget="image"/>
                        </group>
                    </group>

                    <group>
                        <group>
                            <field name="active"/>
                            <field name="start_date" readonly="status in['progress']"/>
                            <field name="duration"/>
                            <field name="delivery_date"/>
                        </group>
                        <group>
                            <field name="service_type" readonly="status in['progress']"/>
                            <field name="estimated_amt"/>


                            <field name="repair_tags" widget="many2many_tags"
                                   options="{'color_field': 'color', 'no_create_edit': True}"/>
                            <field name="company"/>

                        </group>
                    </group>
                    <notebook>
                        <page string="Customer complaints">
                            <group>
                                <field name="customer_complaints"/>

                            </group>
                        </page>

                        <page string="Price details">
                            <field name="consumed_parts_ids">
                                <list editable="bottom">
                                    <field name="product_id"/>
                                    <field name="product_uom_qty"/>
                                    <field name="list_price"/>
                                    <field name="currency_id"/>
                                    <field name="total_price"/>
                                </list>

                            </field>
                            <group style="margin-left: 85%">
                                <field name="total_sum_sum"/>
                            </group>

                        </page>

                        <page string="Labour cost" invisible="service_type not in['paid']">
                            <field name="labour_cost_ids">
                                <list editable="bottom">
                                    <field name="user_id"/>
                                    <field name="hourly_cost"/>
                                    <field name="worked_hours"/>
                                    <field name="sub_total_cost"/>

                                </list>

                            </field>

                            <group style="margin-left: 85%">
                                <field name="labour_cost_sum"/>
                            </group>

                        </page>
                    </notebook>
                </sheet>
                <chatter/>

            </form>
        </field>
    </record>

    <data noupdate="1">
        <record id="reference_number_seq" model="ir.sequence">
            <field name="name">Reference number Sequence</field>
            <field name="code">vehicle.repair.code</field>
            <field name="prefix">REP/</field>
            <field name="padding">5</field>
            <field name="number_next">1</field>
            <field name="number_increment">1</field>
        </record>
    </data>

    <record id="action_vehicle_repair_home" model="ir.actions.act_window">
        <field name="name">Vehicle Repair</field>
        <field name="res_model">vehicle.repair</field>
        <field name="view_mode">list,form,kanban,graph,pivot</field>
    </record>

    <record id="action_vehicle_repair_search" model="ir.ui.view">
        <field name="name">repair.search</field>
        <field name="model">vehicle.repair</field>
        <field name="arch" type="xml">
            <search string="name">
                <field name="reference_number" string="Sequence"/>
                <field name="vehicle_number" string="Vehicle Number"/>
                <field name="name" string="Customer"/>
                <field name="service_advisor_id" string="Responsible User"/>
                <field name="vehicle_type" string="Vehicle Type"/>

                <separator/>
                <filter string="Archived" name="inactive"
                        domain="[('active', '=', False)]"/>
                <filter string="State" name="status"
                        domain="[('status','in',('draft','progress','delivery','done','cancelled'))]"
                        icon="terp-project"/>

                <group expand="1" string="Group By">
                    <filter string="customer" name="name"
                            context="{'group_by':'name', 'residual_visible':True}"/>

                    <filter string="Responsible user" name="service_advisor_id"
                            context="{'group_by':'service_advisor_id', 'residual_visible':True}"/>

                    <filter string="State" name="status"
                            context="{'group_by':'status', 'residual_visible':True}"/>

                    <filter string="Vehicle Type" name="vehicle_type"
                            context="{'group_by':'vehicle_type', 'residual_visible':True}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_vehicle_repair_tags_list_view"
            model="ir.ui.view">
        <field name="name">vehicle tags list</field>
        <field name="model">vehicle.tags</field>
        <field name="arch" type="xml">
            <list string="Channel">
                <field name="name"/>
                <field name="color" widget="color_picker"/>
            </list>
        </field>
    </record>

    <record id="action_vehicle_repair_tags_form_view" model="ir.ui.view">
        <field name="name">Repair tags.form</field>
        <field name="model">vehicle.tags</field>
        <field name="arch" type="xml">
            <form string="Vehicle repair Tags form view">
                <header>

                </header>
                <sheet>
                    <group>
                        <field name="name" options="{'color_field': 'color'}"/>
                        <field name="color" widget="color_picker"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="action_vehicle_repair_tags" model="ir.actions.act_window">
        <field name="name">Vehicle Repair Tags</field>
        <field name="res_model">vehicle.tags</field>
        <field name="view_mode">list,form</field>
    </record>

</odoo>